<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<title>Affablebean</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<link rel="stylesheet" type="text/css"
	href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">

<link rel="stylesheet" type="text/css" media="all"
	href="../../css/affablebean.css" th:href="@{/css/affablebean.css}" />

</head>

<body>
	<div id="main">
		<div th:replace="fragments/header.html :: frag_header"></div>
		<div th:replace="fragments/index.html :: frag_index"></div>
	</div>

        <div id="main">
            <div id="header">
                <div id="widgetBar"></div>

                <a href="<c:url value='../index.jsp'/>">
                    <img src="../img/logo.png" alt="Affable Bean logo" id="adminLogo">
                </a>

                <img src="../img/logoText.png" id="logoText" alt="the affable bean">
            </div>

            <h2>admin console</h2>
            
			<div id="adminMenu" class="alignLeft">
				<p><a th:href="@{/viewCustomers}">view all customers</a></p>
			
				<p><a th:href="@{/viewOrders}">view all orders</a></p>
			
				<p><a th:href="@{/viewFeedback}">view all feedback</a></p>
			
				<p><a th:href="@{/viewCustomers}">log out</a></p>
			</div>
			
			<%-- customerList is requested --%>
			<c:if test="${!empty customerList}">
			
				<table id="adminTable" class="detailsTable">
			
					<tr class="header">
						<th colspan="4">customers</th>
					</tr>
			
					<tr class="tableHeading">
						<td>customer id</td>
						<td>name</td>
						<td>email</td>
						<td>phone</td>
					</tr>
			
					<c:forEach var="customer" items="${customerList}" varStatus="iter">
			
						<tr class="${((iter.index % 2) == 1) ? 'lightBlue' : 'white'} tableRow"
								onclick="document.location.href = 'customerRecord?${customer.id}'">
			
							<%-- Below anchor tags are provided in case JavaScript is disabled --%>
							<td><a href="customerRecord?${customer.id}" class="noDecoration">${customer.id}</a></td>
							<td><a href="customerRecord?${customer.id}" class="noDecoration">${customer.name}</a></td>
							<td><a href="customerRecord?${customer.id}" class="noDecoration">${customer.email}</a></td>
							<td><a href="customerRecord?${customer.id}" class="noDecoration">${customer.phone}</a></td>
						</tr>
			
					</c:forEach>
			
				</table>
			
			</c:if>
			
			<%-- orderList is requested --%>
			<c:if test="${!empty orderList}">
			
				<table id="adminTable" class="detailsTable">
			
					<tr class="header">
						<th colspan="4">orders</th>
					</tr>
			
					<tr class="tableHeading">
						<td>order id</td>
						<td>confirmation number</td>
						<td>amount</td>
						<td>date created</td>
					</tr>
			
					<c:forEach var="order" items="${orderList}" varStatus="iter">
			
						<tr class="${((iter.index % 2) == 1) ? 'lightBlue' : 'white'} tableRow"
								onclick="document.location.href = 'orderRecord?${order.id}'">
			
							<%-- Below anchor tags are provided in case JavaScript is disabled --%>
							<td><a href="orderRecord?${order.id}" class="noDecoration">${order.id}</a></td>
							<td><a href="orderRecord?${order.id}" class="noDecoration">${order.confirmationNumber}</a></td>
							<td><a href="orderRecord?${order.id}" class="noDecoration">
									<fmt:formatNumber type="currency"
																		currencySymbol="&euro; "
																		value="${order.amount}"/></a></td>
			
							<td><a href="orderRecord?${order.id}" class="noDecoration">
									<fmt:formatDate value="${order.dateCreated}"
																	type="both"
																	dateStyle="short"
																	timeStyle="short"/></a></td>
						</tr>
			
					</c:forEach>
			
				</table>
			
			</c:if>
			
			<%-- feedbackList is requested --%>
			<c:if test="${!empty feedbackList}">
			
				<table id="adminTable" class="detailsTable">
			
					<tr class="header">
						<th colspan="4">orders</th>
					</tr>
			
					<tr class="tableHeading">
						<td>subject</td>
						<td>name</td>
						<td>email</td>
						<td>message</td>
					</tr>
			
					<c:forEach var="msg" items="${feedbackList}" varStatus="iter">
			
						<tr class="${((iter.index % 2) == 1) ? 'lightBlue' : 'white'} tableRow"
								onclick="document.location.href = 'feedbackRecord?${msg.id}'">
			
							<%-- Below anchor tags are provided in case JavaScript is disabled --%>
							<td><a href="feedbackRecord?${msg.id}" class="noDecoration">${msg.subjectId.name}</a></td>
							<td><a href="feedbackRecord?${msg.id}" class="noDecoration">${msg.name}</a></td>
							<td><a href="feedbackRecord?${msg.id}" class="noDecoration">${msg.email}</a></td>
							<td><a href="feedbackRecord?${msg.id}" class="noDecoration">${msg.msg}</a></td>
						</tr>
			
					</c:forEach>
			
				</table>
			
			</c:if>
			
			<%-- customerRecord is requested --%>
			<c:if test="${!empty customerRecord}">
			
				<table id="adminTable" class="detailsTable">
			
					<tr class="header">
						<th colspan="2">customer details</th>
					</tr>
					<tr>
						<td style="width: 290px"><strong>customer id:</strong></td>
						<td>${customerRecord.id}</td>
					</tr>
					<tr>
						<td><strong>name:</strong></td>
						<td>${customerRecord.name}</td>
					</tr>
					<tr>
						<td><strong>email:</strong></td>
						<td>${customerRecord.email}</td>
					</tr>
					<tr>
						<td><strong>phone:</strong></td>
						<td>${customerRecord.phone}</td>
					</tr>
					<tr>
						<td><strong>address:</strong></td>
						<td>${customerRecord.address}</td>
					</tr>
					<tr>
						<td><strong>city region:</strong></td>
						<td>${customerRecord.cityRegion}</td>
					</tr>
					<tr>
						<td><strong>credit card number:</strong></td>
						<td>${customerRecord.ccNumber}</td>
					</tr>
			
					<tr><td colspan="2" style="padding: 0 20px"><hr></td></tr>
			
					<tr class="tableRow"
							onclick="document.location.href = 'orderRecord?${order.id}'">
						<td colspan="2">
							<%-- Anchor tag is provided in case JavaScript is disabled --%>
							<a href="orderRecord?${order.id}" class="noDecoration">
								<strong>view order summary &#x279f;</strong></a></td>
					</tr>
				</table>
			
			</c:if>
			
			<th:block th:if="${not feedbackRecord} == null}">
			
				<table id="adminTable" class="detailsTable">
			
					<tr class="header">
						<th colspan="2">message details</th>
					</tr>
					<tr>
						<td style="width: 290px"><strong>message id:</strong></td>
						<td th:text="${feedbackRecord.id}">
						</td>
					</tr>
					<tr>
						<td><strong th:text="#{subject} + ':'"></strong></td>
						<td th:text="${feedbackRecord.subject.name}">
						</td>
					</tr>
					<tr>
						<td><strong th:text="#{name} + ':'"></strong></td>
						<td th:text="${feedbackRecord.name}">
						</td>
					</tr>
					<tr>
						<td><strong th:text="#{email} + ':'"></strong></td>
						<td th:text="${feedbackRecord.email}">
						</td>
					</tr>
					<tr>
						<td><strong th:text="#{coMsg} + ':'"></strong></td>
						<td th:text="${feedbackRecord.msg}">
						</td>
					</tr>
					
				</table>
			</th:block>
			
			<th:block th:if="${not orderRecord == null}">
			
				<table id="adminTable" class="detailsTable">
			
					<tr class="header">
						<th colspan="2">order summary</th>
					</tr>
					<tr>
						<td><strong>order id:</strong></td>
						<td th:text="${orderRecord.id}">
						</td>
					</tr>
					<tr>
						<td><strong>confirmation number:</strong></td>
						<td th:text="${orderRecord.confirmationNumber}">
						</td>
					</tr>
					<tr>
						<td><strong th:text="#{dateProcessed} + ':'"></strong></td>
						<td th:text="${#dates.format(orderRecord.dateCreated, 'MM/dd/yyyy HH:mm')}">
						</td>
					</tr>
			
					<tr>
						<td colspan="2">
							<table class="embedded detailsTable">
								<tr class="tableHeading">
									<td class="rigidWidth">product</td>
									<td class="rigidWidth">quantity</td>
									<td>price</td>
								</tr>
			
								<tr><td colspan="3" style="padding: 0 20px"><hr></td></tr>
			
								<th:block th:each="orderedProduct, iterStat : ${orderedProducts}">
								
									<tr>
										<td th:text="#{${products[iterStat.index].name}}">
										</td>
										
										<td th:text="${orderedProduct.quantity}">
										</td>
										
										<td class="confirmationPriceColumn">
											&euro; 
											<span th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 2, 'POINT')}">
												10.00
											</span>
										</td>										
										<td class="confirmationPriceColumn" th:text="${orderedProduct.quantity}">
											&euro; 
											<span th:with="total=${products[iterStat.index].price} * ${orderedProduct.quantity}" 
												th:text="${#numbers.formatDecimal(total, 0, 'COMMA', 2, 'POINT')}"></span>						
										</td>
									</tr>
			
								 
								</th:block>
											
								<tr><td colspan="3" style="padding: 0 20px"><hr></td></tr>
			
								<tr>
									<td colspan="2" id="deliverySurchargeCellLeft"><strong th:text="#{surcharge} + ':'"></strong></td>
									<td id="deliverySurchargeCellRight">
										&euro; 
										<span th:text="${#numbers.formatDecimal(deliverySurcharge, 0, 'COMMA', 2, 'POINT')}"></span>						
									</td>
								</tr>
			
								<tr>
									<td colspan="2" id="totalCellLeft"><strong th:text="#{total} + ':'"></strong></td>
									<td id="totalCellRight">
										&euro; 
										<span th:text="${#numbers.formatDecimal(orderRecord.amount, 0, 'COMMA', 2, 'POINT')}"></span>						
								</tr>
							</table>
						</td>
					</tr>
			
					<tr><td colspan="3" style="padding: 0px 20px"><hr></td></tr>
			
					<tr class="tableRow" th:onclick="document.location.href='customerRecord?id=__${customer.id}__'">
						<td colspan="2">
<!-- 							<%-- Anchor tag is provided in case JavaScript is disabled --%> -->
							<a th:href="@{customerRecord(id=${customer.id})}" class="noDecoration">
								<strong>view customer details &#x279f;</strong></a></td>
					</tr>
				</table>			
			</th:block>
            
            <div id="footer"></div>
        </div>
        
	<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

	<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function(){
            $('tr.tableRow').hover(
                function () {
                    $(this).addClass('selectedRow');
                },
                function () {
                    $(this).removeClass('selectedRow');
                }
            );
         });
    </script>
        
</body>
</html>
